# .gitlab-ci.yml

variables:
  GIT_DEPTH: "1"
  GIT_STRATEGY: fetch

image: golang:latest

before_script:
  - date
  - pwd
  - ls -lah
  - whoami
  - id

stages:
  - placeholder
  - main

.placeholder:
  stage: placeholder
  variables:
    GIT_STRATEGY: none
  script: echo # CI breaks when none of the job meet condition to be executed

push:
  stage: main
  variables:
    DEBIAN_FRONTEND: 'noninteractive'
  before_script:
    - apt-get update -y && apt-get install -y openssl make curl git golang-go
  script:
    - PLASMACTL_ARTIFACT_REPOSITORY_USER_PW_TMP="$(echo "${PLASMACTL_ARTIFACT_REPOSITORY_USER_PW_BASE64}" | base64 -d)"
    - PLASMACTL_ARTIFACT_REPOSITORY_USER_PW='${PLASMACTL_ARTIFACT_REPOSITORY_USER_PW_TMP}' make all

